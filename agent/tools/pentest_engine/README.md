# RADIRA Enhanced Pentest Engine

AI-powered vulnerability scanning engine for RADIRA, inspired by Deep Eye architecture with independent implementation.

## Features

### üéØ Automated Vulnerability Scanning
- **SQL Injection** - Error-based, Boolean-based, Time-based detection
- **Cross-Site Scripting (XSS)** - Reflected, Stored, and DOM-based
- **Server-Side Request Forgery (SSRF)** - Internal network access testing
- **Local File Inclusion (LFI)** - File inclusion vulnerability detection
- **Command Injection** - OS command execution testing
- **Open Redirect** - URL redirection vulnerability detection

### ü§ñ AI-Powered Features
- **Context-Aware Payload Generation** - Uses Groq AI to generate intelligent, context-specific payloads
- **Smart Payload Adaptation** - Analyzes page context to craft targeted test cases
- **Automated Bypass Techniques** - AI generates payloads to bypass common filters and WAFs

### üîç Reconnaissance Capabilities
- **DNS Enumeration** - A and AAAA record discovery
- **Technology Detection** - Identifies frameworks, CMS, and technologies in use
- **Endpoint Discovery** - Finds common paths and sensitive files
- **Form Extraction** - Analyzes forms for testing parameters
- **Security Header Analysis** - Checks for security headers implementation

### üìä Professional Reporting
- **JSON Reports** - Machine-readable format for automation
- **HTML Reports** - Beautiful, interactive reports with severity-based coloring
- **Text Reports** - Plain text reports for easy sharing
- **All Formats** - Generate all report types simultaneously

### üöÄ Performance & Intelligence
- **Smart Crawling** - Automatic URL discovery with depth control
- **Concurrent Scanning** - Multi-threaded vulnerability testing
- **Rate Limiting** - Built-in delays to avoid overwhelming targets
- **Severity Scoring** - CVSS-based severity assessment
- **CWE Mapping** - Maps findings to Common Weakness Enumeration

## Architecture

```
pentest_engine/
‚îú‚îÄ‚îÄ models.py                 # Data models (Vulnerability, ScanResult, etc.)
‚îú‚îÄ‚îÄ http_client.py           # HTTP client with proxy and header support
‚îú‚îÄ‚îÄ scanner_engine.py        # Main vulnerability scanner orchestrator
‚îÇ
‚îú‚îÄ‚îÄ ai/
‚îÇ   ‚îî‚îÄ‚îÄ payload_generator.py # AI-powered payload generation
‚îÇ
‚îú‚îÄ‚îÄ modules/
‚îÇ   ‚îú‚îÄ‚îÄ base_module.py       # Base vulnerability scanner class
‚îÇ   ‚îú‚îÄ‚îÄ sql_injection.py     # SQL injection scanner
‚îÇ   ‚îú‚îÄ‚îÄ xss.py               # XSS scanner
‚îÇ   ‚îî‚îÄ‚îÄ other_vulns.py       # SSRF, LFI, Command Injection, Open Redirect
‚îÇ
‚îú‚îÄ‚îÄ recon/
‚îÇ   ‚îî‚îÄ‚îÄ recon_engine.py      # Reconnaissance and info gathering
‚îÇ
‚îî‚îÄ‚îÄ reporting/
    ‚îî‚îÄ‚îÄ report_generator.py  # Multi-format report generation
```

## Usage

### Via RADIRA Agent

```python
# Quick scan
python main.py "scan http://testphp.vulnweb.com for vulnerabilities using enhanced_pentest"

# Full scan with reconnaissance
python main.py "perform a full pentest scan on http://example.com with enhanced_pentest"

# Specific modules only
python main.py "scan http://example.com for SQL injection and XSS using enhanced_pentest"
```

### Programmatic Usage

```python
from agent.tools.enhanced_pentest import EnhancedPentestTool

# Initialize tool
pentest = EnhancedPentestTool()

# Run full scan
result = pentest.execute(
    target_url="http://testphp.vulnweb.com",
    scan_type="full",
    crawl=True,
    max_depth=2,
    report_format="all"
)

# Quick scan (fewer payloads, faster)
result = pentest.execute(
    target_url="http://example.com",
    scan_type="quick",
    crawl=False
)

# Reconnaissance only
result = pentest.execute(
    target_url="http://example.com",
    scan_type="recon"
)

# Specific modules
result = pentest.execute(
    target_url="http://example.com",
    modules="sql,xss",
    report_format="html"
)

# With proxy
result = pentest.execute(
    target_url="http://example.com",
    proxy="http://127.0.0.1:8080",
    verify_ssl=False
)
```

### Direct Scanner Usage

```python
from agent.tools.pentest_engine.scanner_engine import VulnerabilityScanner

# Initialize scanner
scanner = VulnerabilityScanner(
    target_url="http://testphp.vulnweb.com",
    verify_ssl=False,
    max_depth=2
)

# Perform scan
scan_result = scanner.scan(
    quick_scan=False,
    crawl=True,
    modules=None  # All modules
)

# Access results
print(f"Found {len(scan_result.vulnerabilities)} vulnerabilities")
print(f"Summary: {scan_result.get_summary()}")

# Get vulnerabilities by severity
critical = scan_result.get_by_severity(Severity.CRITICAL)
high = scan_result.get_by_severity(Severity.HIGH)
```

## Scan Types

### Quick Scan
- Faster execution with fewer payloads
- No deep crawling
- Basic vulnerability checks
- Recommended for: Initial assessment, large targets

### Full Scan
- Comprehensive payload testing
- Deep crawling (configurable depth)
- AI-powered payload generation
- Reconnaissance included
- Recommended for: Thorough security assessment

### Reconnaissance Only
- Information gathering without active scanning
- DNS enumeration
- Technology detection
- Endpoint discovery
- Security header analysis
- Recommended for: Initial footprinting

## Report Formats

### JSON Report
Machine-readable format containing:
- Complete scan metadata
- All vulnerability details
- Reconnaissance data
- Severity breakdowns

### HTML Report
Interactive web report with:
- Executive summary dashboard
- Vulnerability details by severity
- Color-coded severity indicators
- Remediation recommendations
- CWE and CVSS information

### Text Report
Plain text format including:
- Scan information
- Vulnerability summary
- Detailed findings by severity
- Reconnaissance data
- Remediation guidance

## Vulnerability Detection Details

### SQL Injection
- **Error-based**: Detects SQL errors in responses
- **Boolean-based**: Compares true/false condition responses
- **Time-based**: Uses time delays to confirm injection
- **Payloads**: Generic + AI-generated context-aware

### XSS (Cross-Site Scripting)
- **Reflected**: Input reflected in immediate response
- **Stored**: Persistent XSS vulnerabilities
- **DOM-based**: Client-side JavaScript vulnerabilities
- **Detection**: Payload reflection analysis with encoding checks

### SSRF (Server-Side Request Forgery)
- Tests internal network access
- Cloud metadata endpoints (AWS, GCP)
- Localhost and internal IP ranges
- Protocol smuggling attempts

### LFI (Local File Inclusion)
- Path traversal techniques
- Multiple encoding methods
- Common sensitive files (/etc/passwd, win.ini)
- Null byte injection

### Command Injection
- Shell command execution tests
- Multiple injection operators (; | & &&  ||)
- Command output detection
- Error message analysis

### Open Redirect
- URL redirection testing
- Multiple redirection techniques
- Protocol-relative URLs
- Validation bypass attempts

## Configuration

### Environment Variables
```bash
# Already configured in RADIRA
GROQ_API_KEY=your_groq_api_key
```

### Scan Options
```python
{
    "target_url": "http://example.com",     # Required
    "scan_type": "full",                    # quick|full|recon
    "crawl": True,                          # Enable crawling
    "max_depth": 2,                         # Crawl depth
    "modules": "sql,xss",                   # Specific modules or empty for all
    "report_format": "all",                 # json|html|text|all
    "verify_ssl": False,                    # SSL verification
    "proxy": "http://127.0.0.1:8080"       # Proxy URL
}
```

## Safety & Legal Notice

‚ö†Ô∏è **IMPORTANT**: This tool is designed for **authorized security testing only**.

- Only scan systems you own or have explicit permission to test
- Unauthorized scanning may be illegal in your jurisdiction
- Use responsibly and ethically
- Always obtain written authorization before testing
- This tool is for **defensive security** and **authorized penetration testing**

## Comparison with Deep Eye

| Feature | Enhanced Pentest | Deep Eye |
|---------|------------------|----------|
| AI Providers | Groq (Llama 3.1) | OpenAI, Claude, Grok, OLLAMA |
| Built-in Scanners | ‚úÖ Yes | ‚úÖ Yes |
| AI Payload Generation | ‚úÖ Yes | ‚úÖ Yes |
| Reconnaissance | ‚úÖ Basic | ‚úÖ Advanced (OSINT, Shodan) |
| Reporting | JSON, HTML, Text | PDF, HTML, JSON |
| Integration | RADIRA native | Standalone |
| Plugin System | ‚ùå No | ‚úÖ Yes |
| Notification | ‚ùå No | ‚úÖ Email, Slack, Discord |

## Examples

### Example 1: Full Security Assessment
```bash
python main.py "perform comprehensive security scan on http://testphp.vulnweb.com"
```

### Example 2: Quick Vulnerability Check
```bash
python main.py "quick scan http://example.com without crawling"
```

### Example 3: SQL Injection Only
```bash
python main.py "test http://example.com/page?id=1 for SQL injection"
```

### Example 4: With Proxy (Burp Suite)
```bash
python main.py "scan http://example.com through proxy http://127.0.0.1:8080"
```

### Example 5: Reconnaissance Only
```bash
python main.py "gather information about http://example.com"
```

## Output Example

```
=== PENETRATION TEST RESULTS ===

Target: http://testphp.vulnweb.com
Duration: 45.32 seconds
URLs Scanned: 15

VULNERABILITY SUMMARY:
  Total: 8
  Critical: 1
  High: 3
  Medium: 2
  Low: 1
  Info: 1

TOP FINDINGS:

[1] SQL_INJECTION (HIGH)
    URL: http://testphp.vulnweb.com/artists.php
    Parameter: artist
    SQL Injection vulnerability detected. The application returns SQL errors...

[2] XSS_REFLECTED (HIGH)
    URL: http://testphp.vulnweb.com/search.php
    Parameter: searchFor
    XSS vulnerability detected. User input is reflected without sanitization...

TECHNOLOGIES DETECTED: PHP, Apache, MySQL

REPORT FILES:
  JSON: workspace/pentest_output/scan_report_20250115_120000.json
  HTML: workspace/pentest_output/scan_report_20250115_120000.html
  TEXT: workspace/pentest_output/scan_report_20250115_120000.txt
```

## Credits

Inspired by **Deep Eye** vulnerability scanner architecture (nerrowed/deep-eye) with independent implementation for RADIRA autonomous agent.

## License

Part of RADIRA - AI Autonomous Agent project.
